package org.evosuite.coverage.vulnerability;

import java.io.Serializable;
import java.util.List;
import java.util.Objects;

public class VulnerabilityCoverageGoal implements Serializable {
    private final int id;
    private final List<Call> calls;

    public VulnerabilityCoverageGoal(int id, List<Call> calls) {
        this.id = id;
        this.calls = calls;
    }

    public int getId() {
        return id;
    }

    public List<Call> getCalls() {
        return calls;
    }

    @Override
    public String toString() {
        return "VulnerabilityCoverageGoal{" +
                "id=" + id +
                ", calls=" + calls +
                '}';
    }

    static class Call {
        private final String method;
        private final String staticCallerClass;
        private final List<String> alternativeCallerClasses;

        public Call(String method, String staticCallerClass, List<String> alternativeCallerClasses) {
            Objects.requireNonNull(method, "method must not be null");
            Objects.requireNonNull(staticCallerClass, "staticCallerClass must not be null");
            Objects.requireNonNull(alternativeCallerClasses, "alternativeCallerClasses must not be null");
            this.method = method;
            this.staticCallerClass = staticCallerClass;
            this.alternativeCallerClasses = alternativeCallerClasses;
        }

        public String getMethod() {
            return method;
        }

        public String getStaticCallerClass() {
            return staticCallerClass;
        }

        public List<String> getAlternativeCallerClasses() {
            return alternativeCallerClasses;
        }

        @Override
        public String toString() {
            return "Call{" +
                    "method='" + method + '\'' +
                    ", staticCallerClass='" + staticCallerClass + '\'' +
                    ", alternativeCallerClasses=" + alternativeCallerClasses +
                    '}';
        }
    }
}
