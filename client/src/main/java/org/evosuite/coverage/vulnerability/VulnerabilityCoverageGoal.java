package org.evosuite.coverage.vulnerability;

import org.evosuite.setup.CallContext;

import java.io.Serializable;

public class VulnerabilityCoverageGoal implements Serializable {
    private final int id;
    private final String entryClass;
    private final CallContext targetContext;

    // To avoid an RMI exception (due to a ClassLoader object inside the entire structure), this field has been made transient.
    // An alternative would be put transient keyword into the ClassLoader field in ByteCodeInstruction and BasicBlock classes.
    // Other solutions are well accepted
    // private final transient List<ControlDependency> targetControlNodes;
    // private final int targetLine;

    public VulnerabilityCoverageGoal(int id, String entryClass, CallContext targetContext) {
        this.id = id;
        this.entryClass = entryClass;
        if (targetContext == null) {
            throw new IllegalArgumentException("Target call context cannot be null.");
        }
        this.targetContext = targetContext;
    }

    public int getId() {
        return id;
    }

    public CallContext getTargetContext() {
        return targetContext;
    }

    public String getEntryClass() {
        return entryClass;
    }

    @Override
    public String toString() {
        return "VulnerabilityCoverageGoal{" +
                "id=" + id +
                ", callingClient='" + entryClass + '\'' +
                ", targetContext=" + targetContext +
                '}';
    }
}
