package org.evosuite.coverage.reachability;

import org.evosuite.coverage.branch.Branch;
import org.evosuite.seeding.StaticConstantPool;

import java.util.LinkedHashMap;
import java.util.Map;

public class ReachabilityBranchConstantPool {
    private static Map<Branch, StaticConstantPool> pools = new LinkedHashMap<>();

    public static void add(Branch branch, Object object) {
        StaticConstantPool staticConstantPool = pools.get(branch);
        if (staticConstantPool == null) {
            StaticConstantPool newBranchConstants = new StaticConstantPool();
            newBranchConstants.add(object);
            pools.put(branch, newBranchConstants);
        } else {
            staticConstantPool.add(object);
        }
    }

    public static StaticConstantPool getBranchConstantPool() {
        StaticConstantPool fullPool = new StaticConstantPool();
        for (StaticConstantPool pool : pools.values()) {
            pool.getObjects().forEach(fullPool::add);
        }
        return fullPool;
    }

    public static void reset() {
        pools = new LinkedHashMap<>();
    }
}
